// app.js - Insecure Design Example (CWE-862: Missing Authorization)
const express = require('express');
const app = express();

// Simulating a list of sensitive information
const sensitiveData = {
    'admin': ['user1', 'user2', 'user3'],
    'user': ['user3', 'user4']
};

// Insecure route that exposes sensitive data to everyone
app.get('/data', (req, res) => {
    const { user } = req.query;

    // No access control, anyone can access sensitive data
    if (sensitiveData[user]) {
        res.json(sensitiveData[user]);
    } else {
        res.send('No access');
    }
});

app.listen(3000, () => {
    console.log('Server is running on http://localhost:3000');
});

